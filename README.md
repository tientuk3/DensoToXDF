# DensoToXDF
## Introduction

This tool generates TunerPro `.xdf` definition files from Denso SuperH/M32R ECU firmware binaries. It automatically locates the map lookup table and parses the data into a definition file that can be used to adjust the maps (e.g. fueling and ignition) in TunerPro. Compatible with Denso ECUs from 2000..2010 based on e.g. SH7052, SH7054 and M32R 32196.

## Background

Denso SuperH/M32R-based ECUs contain a map lookup table, which specifies most of the maps (=precalculated functions) used by the ECU logic (such as ignition or fuel parameters as a function of various other data).
The lookup table contains the dimensions of each map, the hexadecimal offsets for the axis and map data, and their data format.
This program pulls that information and writes a TunerPro definition file based on the data, which one can use to further examine, name and adjust the maps in TunerPro.
By default, the maps will be named as follows: **"(2D or 3D) map x(x-axis length)y(y-axis length) at (z-axis data offset)"**. Usually maps related to particular functionality (e.g. fuel calculations) are located one after another.

The list generated by the program is comprehensive, but not exhaustive. The reason being is that some smaller "maps" (switch-type parameters, and such) are not specified in the lookup table,
but are stored and referenced word by word. Finding these will require some reverse engineering with your favorite disassembler.

## How to use

### Requirements

Python 3.7+

### Command line usage

`python xdfgenerator.py [--position HEX_OFFSET] <in_file> <out_file>`

| Argument         | Description                                                                 |
|------------------|-----------------------------------------------------------------------------|
| `<in_file>`      | Path to the input Denso ECU binary file                                     |
| `<out_file>`     | Path where the output `.xdf` file will be written                           |
| `--position`     | (Optional) Hexadecimal offset to the start of the map lookup table (e.g. `0x2C000`). If not provided, the tool will attempt to locate it automatically. |

## Supported models

At least numerous motorcycles (Suzuki, Kawasaki) from ~2002-2010 and apparently many Japanese cars as well. I'd like to hear about success or issues with specific models.

